---
title: message flow ê´€ë ¨ ì¡°ì‚¬ 
author: Chaewon Kim
date: 2026-01-21
category: Jekyll
layout: post
---

ì˜¤ëŠ˜ì€ ìë£Œì¡°ì‚¬ í•˜ëŠ” ë‚  



Timing Analysis and Priority-driven Enhancements of ROS 2 Multi-threaded Executors

Theory-Guided Adaptive Scheduling for ROS 2

Response Time Analysis for Dynamic Priority Scheduling in ROS 2 


All message exchange is handled by DDS, which ensures both real-time performance and relibale data transfer

the fundamental unit of communication is the node

DDS adopts the User Datagram Protocol (UDP) as its default transport layer


Despite these advantages, current DDS implementations show clear limitations in large-payload transmissions. 


https://tier4.github.io/caret_doc/main/installation/installation/ 


### 0122

**ë…¼ë¬¸ì´ ì€ê·¼ ê°œë…ì„¤ëª… ì˜ ë˜ì–´ì‡ì–´ì„œ ì½ê¸° ì¢‹ì€ê±°ê°™ìŒ**

message type?

message ë³´ë‚´ëŠ” ì£¼ì²´ : Publisher

message ë°›ëŠ” ì£¼ì²´ : Subscriber

message ë³´ë‚´ëŠ” íë¦„

![alt text](/assets/Communication/ROS2%20end-to-end%20communication%20stack.png)

the RCL interacts with the selected DDS implementation through the RMW interface 

Each ROS communication entiry is mapped one to tone to a corresponding DDSë‘ìƒ¤ì‡¼

publisher â†’ DDS datawriter
subscription â†’ DDS datareader

DDS serves as middleware that bridges ROS applications
to the underlying OS network layer,

 transporting **serialized messages** over the RTPS protocol while providing discovery (sessionestablishment) and reliable transmission

DataWriter and DataReader maintains a dedicated HistoryCache, specifically, a WriterHistoryCache and a ReaderHistoryCache. 

- RTPS (Real-Time Publish Subscribe): DDSê°€ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ì„ ë•Œ ì“°ëŠ” êµ­ì œ í‘œì¤€ í†µì‹  ê·œì•½ì…ë‹ˆë‹¤. (íƒë°° ê¸°ì‚¬ë‹˜ë“¤ì˜ ë°°ì†¡ ë§¤ë‰´ì–¼)

he message sample is first serialized into a CacheChange payload using the CDR or XCDR2 format.

ìš´ì†¡ ìˆ˜ë‹¨ ì„ íƒ (Transport Layer)

    "Depending on the implementation, the transport layer may support UDP, TCP, or shared memory (SHM)."

    ì´ì œ ì´ ì¡°ê°ë‚œ ë°ì´í„°ë“¤ì„ ì‹¤ì–´ ë‚˜ë¥¼ **íŠ¸ëŸ­(Transport)**ì„ ê³ ë¦…ë‹ˆë‹¤.

    ROS 2 DDSëŠ” ë³´í†µ 3ê°€ì§€ íŠ¸ëŸ­ì„ ì§€ì›í•©ë‹ˆë‹¤.

        UDP: ë¹ ë¥´ì§€ë§Œ ê°€ë” ë¬¼ê±´ì„ í˜ë¦´ ìˆ˜ ìˆìŒ (ì˜¤í† ë°”ì´ í€µì„œë¹„ìŠ¤).

        TCP: ëŠë¦¬ì§€ë§Œ ì ˆëŒ€ ì•ˆ í˜ë¦¬ê³  ê¼¼ê¼¼í•¨ (ì¼ë°˜ íƒë°°).

        Shared Memory (SHM): ë„¤íŠ¸ì›Œí¬ë¥¼ ì•ˆ íƒ€ê³  ë©”ëª¨ë¦¬ë¥¼ ì§ì ‘ ê³µìœ í•¨. ê°™ì€ ì»´í“¨í„° ì•ˆì—ì„œëŠ” ì œì¼ ë¹ ë¦„ (ì˜†ë°©ìœ¼ë¡œ ì§ì ‘ ê±´ë„¤ì£¼ê¸°).


íë¦„ë„

- ROS Layer: publish() (ë°ì´í„° ìƒì„±)

- DDS Layer: RTPS í¬ì¥ & WriterHistoryCache ì €ì¥

- Transport Layer: UDP ë´‰íˆ¬ì— ë„£ê¸°

- OS Kernel: UDP ì†Œì¼“ ë²„í¼ ëŒ€ê¸°

- IP Layer: MTUë³´ë‹¤ í¬ë©´ ì¡°ê°ë‚´ê¸°(Fragmentation) âœ‚ï¸

- Hardware (NIC): ë§ ë²„í¼ ëŒ€ê¸° -> ì™€ì´íŒŒì´ ë°œì‚¬ ğŸ“¡

- (ìˆ˜ì‹  ì¸¡): ì—­ìˆœìœ¼ë¡œ ì¡°ë¦½ -> ReaderHistoryCache -> subscribe()


ë¬´ì„  í†µì‹ ì˜ ê²½ìš°  bandwidth ì œí•œ, latency, buffer ì œì•½ìœ¼ë¡œ ì¸í•´ ë³‘ëª© í˜„ìƒ ë°œìƒ 



Message Flow Analysis with Complex Causal Links for Distributed ROS 2 System


ROS2 executor : High level task scheduler which handles ros2 message

visualization of the flow of messages across distributed ros2 systems


message latencies across a
whole system is paramount to assessing the impact of these
new approaches as well as evaluating the overall performance
of a system

we present a message flow analysis method for ROS 2 distributed computation graph


Blass et al. [30], [31]: â˜… í•µì‹¬ ì—°êµ¬

    ë°œê²¬: ROS 2ì˜ **User-Level ìŠ¤ì¼€ì¤„ë§(Executor)**ê³¼ **OS-Level ìŠ¤ì¼€ì¤„ë§(Linux Kernel)**ì´ ì„œë¡œ ì†ë°œì´ ì•ˆ ë§ëŠ”ë‹¤ëŠ” ê²ƒì„ ì§€ì í–ˆìŠµë‹ˆë‹¤.

    ê²°ì •ì  ì›ì¸: Default ExecutorëŠ” íƒ€ì´ë¨¸(Timer) > êµ¬ë…(Subscription) > ì„œë¹„ìŠ¤ ì„œë²„ > í´ë¼ì´ì–¸íŠ¸ ìˆœì„œë¡œ ë¬´ì‹í•˜ê²Œ ìš°ì„ ìˆœìœ„ë¥¼ ê³ ì •í•´ë²„ë¦½ë‹ˆë‹¤.

    ì˜ë¯¸: ë„¤ê°€ ì•„ë¬´ë¦¬ ì¤‘ìš”í•œ ì„¼ì„œ ë°ì´í„°ë¥¼ Subscriptionìœ¼ë¡œ ë°›ì•„ë„, ëœ ì¤‘ìš”í•œ Timerê°€ ë§ìœ¼ë©´ ì˜ì›íˆ ë°€ë¦´ ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤. (Starvation ë°œìƒ)


ROS2 Tracing

when a new publisher object is created -> 3 trace points are triggered
- rlc
- rmw
- dds

globally-unique identifier


TRANSPORT_PRIORITY


CARET



**ëª¨ë¥´ëŠ” ê°œë… ëª¨ìŒ**

dTLB-load-misses

HugePage

eBPF (ë­”ê°€ ê¿€ë²Œ ê·¸ë¦¼ì´ ìµìˆ™í•œë° )

