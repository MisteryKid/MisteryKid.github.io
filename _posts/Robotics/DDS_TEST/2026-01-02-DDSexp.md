---
title: ROS2 DDS ì„±ëŠ¥ ì°¨ì´ ë¶„ì„
author: Chaewon Kim
date: 2026-01-02
categories: [Robotics, ROS2]  # ìƒìœ„: Robotics, í•˜ìœ„: ROS2
layout: post
---


# Nav2 êµ¬ë™ ì‹œ DDSë³„ ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ë¹„êµ ë¶„ì„

## ì„œë¡  

### ì‹¤í—˜ ëª©ì 
- ROS 2 ê¸°ë³¸ ë¯¸ë“¤ì›¨ì–´ì¸ Fast DDSì™€ ëŒ€ì•ˆì¸ Cyclone DDS ì¤‘, ë‚´ í™˜ê²½(32-core ê³ ì‚¬ì–‘ ì›Œí¬ìŠ¤í…Œì´ì…˜)ì—ì„œ ëˆ„ê°€ ë” íš¨ìœ¨ì ì¸ì§€ í™•ì¸.

- ë‹¨ìˆœ í†µì‹ ì´ ì•„ë‹Œ, ë¬´ê±°ìš´ Nav2(ììœ¨ì£¼í–‰) ìŠ¤íƒì„ ëŒë¦´ ë•Œ ì‹¤ì œ CPU ë¶€í•˜ì™€ ìŠ¤ë ˆë“œ ìŠ¤ìœ„ì¹­(Context Switch) ì°¨ì´ë¥¼ ê²€ì¦í•¨.

### ì‹¤í—˜ í™˜ê²½
- H/W: 32-Core Workstation

- S/W: Ubuntu 22.04 (ROS 2 Humble), Nav2, Gazebo

- ë¹„êµêµ°:

    rmw_fastrtps_cpp (Fast DDS - ê¸°ë³¸ê°’)

    rmw_cyclonedds_cpp (Cyclone DDS)

### ì¸¡ì • ë°©ë²•
- í†µì œ ë³€ìˆ˜: ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œë´‡ ì´ˆê¸° ìœ„ì¹˜ì™€ ëª©í‘œ ì§€ì ì„ 100% ë™ì¼í•˜ê²Œ ì„¤ì •.

- ì¸¡ì • ì§€í‘œ: pidstatì„ ì´ìš©í•œ CPU ì‚¬ìš©ë¥ (%usr, %sys), ë©”ëª¨ë¦¬, Context Switch íšŸìˆ˜.

### ê°€ì„¤
- 32ì½”ì–´ í™˜ê²½ì—ì„œëŠ” DDSì˜ ìŠ¤ë ˆë“œ ì²˜ë¦¬ ë°©ì‹ì— ë”°ë¼ ì»¤ë„ ì˜¤ë²„í—¤ë“œ(System Time) ì°¨ì´ê°€ ë°œìƒí•  ê²ƒì´ë‹¤.

### ì‹¤í—˜ ê³¼ì • 
Step 1. í™˜ê²½ ì´ˆê¸°í™” & Gazebo ì‹¤í–‰ (Terminal 1)

Step 2. Nav2 ìŠ¤íƒ ì‹¤í–‰ (Terminal 2)

Step 3. ì‹¤í—˜ ìˆ˜í–‰ (Terminal 3,4)

Step 4. í”„ë¡œì„¸ìŠ¤ ì™„ì „ ì¢…ë£Œ

```
# ê²½ë¡œ ë° ëª…ë ¹ì–´ ì •ë¦¬

export RMW_IMPLEMENTATION=rmw_cyclonedds_cpp

ros2 daemon stop; ros2 daemon start

~/nav_ws/Exp/gaze_test$ ./gaze.sh

~/nav_ws/Exp/gaze_test$ ./nav.sh

~/nav_ws/Exp/test_DDS$ ./run_mission.sh

~/nav_ws/Exp/test_DDS$ ./monitor.sh

./monitor_only.sh cyclone & sleep 2; ./run_mission.sh

pkill -9 -f ros2
pkill -9 -f nav2
pkill -9 -f gzserver
pkill -9 -f gzclient


âœ… ì˜¬ë°”ë¥¸ ìˆœì„œ (ì´ëŒ€ë¡œë§Œ í•˜ì„¸ìš”)

    ì„¤ì • ì„ ì–¸ (export): "ë‚˜ ì´ì œë¶€í„° Cyclone DDS ì“¸ ê±°ì•¼!" ë¼ê³  ì»´í“¨í„°ì— ì•Œë¦¼.

    ë°ëª¬ ì •ì§€ (stop): "ì˜›ë‚  ì„¤ì •ìœ¼ë¡œ ëŒê³  ìˆë˜ ë°ëª¬ êº¼ì ¸!"

    ë°ëª¬ ì‹œì‘ (start): "ë°©ê¸ˆ ë‚´ê°€ ë§í•œ ì„¤ì •(Cyclone)ìœ¼ë¡œ ë‹¤ì‹œ íƒœì–´ë‚˜ë¼!"

```

## ëª…ë ¹ì–´


#í˜„ì¬ DDS í™•ì¸ 
```
ros2 doctor --report | grep middleware
```

Fast DDSì¼ ë•Œ: middleware name    : rmw_fastrtps_cpp

Cyclone DDSì¼ ë•Œ: middleware name    : rmw_cyclonedds_cpp


ê°±ì‹ í•˜ê¸° ìœ„í•´ ì„¤ì • ì´ˆê¸°í™” ì§„í–‰ 
```
# DDS ë³€ê²½ í›„ í•„ìˆ˜ ì½”ìŠ¤
ros2 daemon stop
ros2 daemon start
```





### ì‹¤í—˜ ë°ì´í„° ëª¨ì•„ë‘” ê³³ 
https://docs.google.com/spreadsheets/d/10NJ4Rm9oHbsgZX_uwaOSO2NtIowHm0w2CY9T8_2BCNw/edit?usp=sharing


32ì½”ì–´ë¼ ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ë³´ì´ì§€ ì•ŠìŒ

-> 4ì½”ì–´ë¡œ ì¤„ì—¬ë²„ë¦¬ê¸° 

```
taskset -c 0-3 ros2 launch nav2_bringup tb3_simulation_launch.py ...

taskset -c 0-3 ./run_mission.sh
```



ë°ì´í„° ì˜ë¯¸

1. ğŸ–¥ï¸ CPU (ê°€ì¥ ì˜¤ë¥¸ìª½) - ì—¬ê¸°ê°€ ë©”ì¸ ë¬´ëŒ€

í”„ë¡œì„¸ì„œê°€ ì‹œê°„ì„ ì–´ë””ì— ì“°ê³  ìˆëŠ”ì§€ ë³´ì—¬ì¤ë‹ˆë‹¤.

    us (User Time): ì‚¬ìš©ì ì˜ì—­.

        ROS 2 ë…¸ë“œ(Nav2, Gazebo ë“±)ê°€ ì‹¤ì œë¡œ ì¼í•˜ëŠ” ì‹œê°„ì…ë‹ˆë‹¤.

    sy (System Time) â­: ì»¤ë„ ì˜ì—­.

        DDS ì‹¤í—˜ì˜ í•µì‹¬ì…ë‹ˆë‹¤. OSê°€ í•˜ë“œì›¨ì–´ë¥¼ ì œì–´í•˜ê±°ë‚˜ í”„ë¡œì„¸ìŠ¤ ê°„ í†µì‹ (DDS)ì„ ì¤‘ì¬í•˜ëŠ” ë° ì“´ ì‹œê°„ì…ë‹ˆë‹¤. Cyclone vs Fast DDS ì¤‘ ëˆ„ê°€ ë” 'ê°€ë³ëƒ'ë¥¼ ë³¼ ë•Œ syê°€ ë‚®ì€ ê²Œ ì¢‹ìŠµë‹ˆë‹¤.

    id (Idle): íœ´ì‹.

        CPUê°€ ë†€ê³  ìˆëŠ” ë¹„ìœ¨ì…ë‹ˆë‹¤. (ë‹˜ ì»´í“¨í„°ëŠ” 32ì½”ì–´ë¼ ì—¬ê¸°ê°€ 90% ì´ìƒì¸ ê²Œ ì •ìƒ)

    wa (Wait I/O): ëŒ€ê¸°.

        í•˜ë“œë””ìŠ¤í¬ë‚˜ ë„¤íŠ¸ì›Œí¬ ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠë¼ ë© ë•Œë¦¬ëŠ” ì‹œê°„ì…ë‹ˆë‹¤.

    st (Stolen): ê°€ë¡œì±„ê¸°.

        ê°€ìƒ ë¨¸ì‹  í™˜ê²½ì—ì„œ í˜¸ìŠ¤íŠ¸ OSì—ê²Œ ëºê¸´ ì‹œê°„(ë³´í†µ 0).

2. âš™ï¸ System (ì¤‘ê°„) - ì´ë²ˆ ì‹¤í—˜ì˜ ìŠ¹ë¶€ì²˜

ìš´ì˜ì²´ì œì˜ ë¶€í•˜ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.

    in (Interrupts): ì¸í„°ëŸ½íŠ¸.

        í•˜ë“œì›¨ì–´(í‚¤ë³´ë“œ, ë§ˆìš°ìŠ¤, ë„¤íŠ¸ì›Œí¬ ì¹´ë“œ)ê°€ CPUë¥¼ "ì ê¹ ë‚˜ ì¢€ ë´ì¤˜!" í•˜ê³  ë¶€ë¥¸ íšŸìˆ˜ì…ë‹ˆë‹¤.

    cs (Context Switches) â­â­â­: ë¬¸ë§¥ êµí™˜.

        ì´ë²ˆ ì‹¤í—˜ì—ì„œ ê°€ì¥ ì¤‘ìš”í•©ë‹ˆë‹¤.

        CPUê°€ Aì‘ì—…ì„ í•˜ë‹¤ê°€ Bì‘ì—…ìœ¼ë¡œ ê°ˆì•„íƒ„ íšŸìˆ˜ì…ë‹ˆë‹¤.

        ROS 2ëŠ” ìˆ˜ë§ì€ ë…¸ë“œ(ìŠ¤ë ˆë“œ)ê°€ í†µì‹ í•˜ë¯€ë¡œ, ì´ ìˆ«ìê°€ ë‚®ì„ìˆ˜ë¡ íš¨ìœ¨ì ì¸ ë¯¸ë“¤ì›¨ì–´ì…ë‹ˆë‹¤. (ì•„ê¹Œ 7ë§Œê¹Œì§€ íŠ€ì—ˆë˜ ê·¸ ë…€ì„ì…ë‹ˆë‹¤.)

3. ğŸš€ Procs (ê°€ì¥ ì™¼ìª½) - í”„ë¡œì„¸ìŠ¤ ìƒíƒœ

    r (Running): ì‹¤í–‰ ì¤‘.

        í˜„ì¬ CPUë¥¼ ì“°ê³  ìˆê±°ë‚˜, ì“°ë ¤ê³  ì¤„ ì„œ ìˆëŠ” í”„ë¡œì„¸ìŠ¤ ê°œìˆ˜ì…ë‹ˆë‹¤. ì½”ì–´ ìˆ˜(32)ë³´ë‹¤ ë‚®ìœ¼ë©´ ì•„ì£¼ ì¾Œì í•œ ê²ë‹ˆë‹¤.

    b (Blocked): ë©ˆì¶¤.

        ë©”ëª¨ë¦¬ë‚˜ ë””ìŠ¤í¬ ì…ì¶œë ¥ì„ ê¸°ë‹¤ë¦¬ëŠë¼ ì ë“¤ì–´ ìˆëŠ” í”„ë¡œì„¸ìŠ¤ì…ë‹ˆë‹¤.

4. ğŸ’¾ Memory & Swap (ì¤‘ê°„ ì™¼ìª½)

    swpd: ê°€ìƒ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ (0ì´ ì¢‹ìŒ).

    free: ë‚¨ì€ ë¨ ìš©ëŸ‰.

    buff: ë²„í¼ ë©”ëª¨ë¦¬.

    cache: ìºì‹œ ë©”ëª¨ë¦¬ (ë¦¬ëˆ…ìŠ¤ëŠ” ë‚¨ëŠ” ë¨ì„ ìºì‹œë¡œ ì¨ì„œ, ì—¬ê¸°ê°€ ë†’ê³  freeê°€ ë‚®ì•„ë„ ì •ìƒì…ë‹ˆë‹¤).

    si / so (Swap In/Out):

        ë¨ì´ ë¶€ì¡±í•´ì„œ í•˜ë“œë””ìŠ¤í¬ë¥¼ ë¨ì²˜ëŸ¼ ì“´ íšŸìˆ˜. ì—¬ê¸°ê°€ 0ì´ ì•„ë‹ˆë©´ ì»´í“¨í„°ê°€ ë¹„ëª… ì§€ë¥´ëŠ” ì¤‘ì¸ ê²ë‹ˆë‹¤. (ë‹¤í–‰íˆ ë¡œê·¸ì—ì„  0ì…ë‹ˆë‹¤.)

5. ğŸ’¿ IO (ì…ì¶œë ¥)

    bi (Blocks In): ë””ìŠ¤í¬ì—ì„œ ì½ì–´ì˜¨ ë°ì´í„° ì–‘.

    bo (Blocks Out): ë””ìŠ¤í¬ì— ì“´ ë°ì´í„° ì–‘ (ë¡œê·¸ íŒŒì¼ ì €ì¥í•  ë•Œ ìˆ˜ì¹˜ê°€ ì˜¬ë¼ê°‘ë‹ˆë‹¤).

    
ğŸ’¡ ìš”ì•½: ë‹˜ ì‹¤í—˜ì—ì„œ ë´ì•¼ í•  ê²ƒ

ë”± 3ê°€ì§€ë§Œ ê¸°ì–µí•˜ì„¸ìš”.

    cs (Context Switch): ë‚®ì„ìˆ˜ë¡ ì¢‹ë‹¤. (DDS íš¨ìœ¨ì„± ì§ê²°)

    sy (System CPU): ë‚®ì„ìˆ˜ë¡ ì¢‹ë‹¤. (ì˜¤ë²„í—¤ë“œ)

    us (User CPU): ë¹„ìŠ·í•˜ê±°ë‚˜ ë‚®ì„ìˆ˜ë¡ ì¢‹ë‹¤. (ì—°ì‚° íš¨ìœ¨)


# ì‹¤í—˜ ë‹¤ì‹œ ì„¤ê³„ (0105)

- ì´ˆì•ˆ ê³„ì† ì‘ì„± ä¸­

- ê¹ê¹í•œ êµìˆ˜ë‹˜ ì»¨ì…‰ ì œë¯¸ë‚˜ì´ì™€ í•¨ê»˜ ì“°ëŠ” ì´ˆì•ˆ & ê³ ë¯¼ê±°ë¦¬ ì •ë¦¬ 


32ì½”ì–´ í™˜ê²½ì—ì„œëŠ” ê·¸ë˜í”„ê°€ ì‹œê°ì ìœ¼ë¡œ í° ì°¨ì´ê°€ ë‚˜ì§€ ì•Šì•„ gazeboì™€ nav2ë¥¼ 4ì½”ì–´ë¡œë§Œ ì—°ì‚°í•˜ë„ë¡ ê°•ì œí•œë‹¤. 
ë˜ ë¡œë´‡ì´ 1íšŒ ì›€ì§ì´ëŠ” ê²ƒ ë§Œìœ¼ë¡œëŠ” í•´ë‹¹ ë¡œë´‡ì´ ì–´ëŠ ìˆœê°„ì— ì—°ì‚°ì´ ì¦ê°€í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ì—†ì–´ ì´ 3ë²ˆì„ ì´ë™í•˜ë„ë¡ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•œë‹¤ .

----
ë…¼ë¬¸ ëŠë‚Œìœ¼ë¡œ ì–´íˆ¬ ë°”ê¾¸ê¸° (ì§€ê¸ˆë¶€í„°ë¼ë„ ì—°ìŠµí•˜ì.)
- ê·¸ë˜í”„ê°€ ì°¨ì´ê°€ ì•ˆë‚˜ì„œ â†’ ë³€ë³„ë ¥ì´ ë‚®ì•„, ì‹œìŠ¤í…œ ë¶€í•˜ ì¦ê° íŒ¨í„´ì„ íŒŒì•…í•˜ê¸° ì–´ë ¤ìš°ë¯€ë¡œ, ìœ ì˜ë¯¸í•œ ì°¨ì´ë¥¼ ê´€ì¸¡í•˜ê¸° ì–´ë ¤ì›Œ
- ì•Œ ìˆ˜ ì—†ì–´ â†’ íŒŒì•…í•˜ê¸° ì–´ë ¤ìš°ë¯€ë¡œ
- ì–´ëŠ ìˆœê°„ì— ì—°ì‚°ì´ ì¦ê°€í•˜ëŠ”ì§€ â†’ ë¶€í•˜(Load)ì˜ ì¦ê° íŒ¨í„´, ë¦¬ì†ŒìŠ¤ ì ìœ ìœ¨ ë³€í™” 
- ê°•ì œí•œë‹¤ â†’ ì œí•œí•˜ì˜€ë‹¤, í• ë‹¹í•˜ì˜€ë‹¤
- ì°¨ì´ë¥¼ ë³´ê³ ì‹¶ì–´ì„œ â†’ ë¶€í•˜ë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•´, ì—°ì‚° íŒ¨í„´ì˜ ì°¨ì´ë¥¼ ê·œëª…í•˜ê³ ì
- ë„ì°© ìˆœê°„ â†’ ëª©í‘œì  ë„ë‹¬(Goal Reaching), ë„ì°© ì‹œì  
- Ildeí•œ ìˆœê°„ â†’ ëŒ€ê¸°(Idle), ì •ì  ìƒíƒœ (Static State)

ì˜ì–´ ë…¼ë¬¸ë§Œ ì½ì§€ ë§ê³  êµ­ë¬¸ë„ ì½ìœ¼ë©´ì„œ ì–´íœ˜ë ¥ ê¸¸ëŸ¬ì•¼ê² ë‹¤.
----

 32 ì½”ì–´ í™˜ê²½ì—ì„œëŠ” ì„±ëŠ¥ ì§€í‘œì˜ **ë³€ë³„ë ¥ì´ ë‚®ì•„**, Gazeboì™€ Nav2ì˜ ì—°ì‚° ìì›ì„ 4ì½”ì–´ë¡œ ì œí•œí•˜ì˜€ë‹¤. ë˜í•œ ì£¼í–‰, ëŒ€ê¸°, ëª©í‘œì  ë„ë‹¬ ë“± ë¡œë´‡ì˜ ìƒíƒœ ë³€í™”ì— ë”°ë¥¸ ì‹œìŠ¤í…œ ë¶€í•˜ë¥¼ ëª…í™•íˆ êµ¬ë¶„í•˜ê¸° ìœ„í•´ ì‚¼ê°í˜• ê¶¤ì ì„ ê·¸ë¦¬ë©° ì¶œë°œì§€ë¡œ íšŒê·€í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ë¥¼ êµ¬ì„±í•˜ì˜€ë‹¤. 

- ê·¸ëŸ¼ ìœ„ì˜ ê³¼ì •ì„ ì™œ ì‹¤í—˜í•˜ëŠëƒ? 
fast DDSì™€ cyclone DDSì˜ ì°¨ì´ë¥¼ ë³´ê³  ì‹¶ì–´ì„œ. 

ì™œ 


## ì‹¤í—˜ì˜ ìµœì¢… ëª©ì  
ë³¸ ì‹¤í—˜ì€ ROS 2ì˜ ì£¼ìš” ë¯¸ë“¤ì›¨ì–´ì¸ Fast DDSì™€ Cyclone DDSì˜ ì‹œìŠ¤í…œ ë¶€í•˜ íŠ¹ì„±ì„ ë¹„êµ ë¶„ì„í•˜ëŠ” ë° ëª©ì ì´ ìˆë‹¤. 32ì½”ì–´ í™˜ê²½ì—ì„œëŠ” ë¯¸ë“¤ì›¨ì–´ ê°„ ì„±ëŠ¥ ì§€í‘œì˜ ë³€ë³„ë ¥ì´ ë‚®ì•„ Gazeboì™€ Nav2ì˜ ìì›ì„ 4ì½”ì–´ë¡œ ì œí•œí•˜ì˜€ìœ¼ë©°, ì£¼í–‰(Motion), ëŒ€ê¸°(Idle), ë„ì°©(Arrival) ë“± ë¡œë´‡ì˜ ìƒíƒœ ë³€í™”ì— ë”°ë¥¸ DDSë³„ ë¦¬ì†ŒìŠ¤ ì ìœ ìœ¨ ì¶”ì´ë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•´ ì‚¼ê° ê¶¤ì ì˜ ì™•ë³µ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì ìš©í•˜ì˜€ë‹¤.


- ì´ ì‹¤í—˜ì´ ì™œ ì˜ë¯¸ìˆì„ê¹Œ? (Contribution(ì˜ì˜), Implication(ì‹œì‚¬ì ))
  


---

### ì œë¯¸ë‚˜ì´ì˜ ì§€ì : 

- Idleì˜ ì •ì˜ê°€ ë¬´ì—‡ì¼ê¹Œ? 
ë°”í€´ëŠ” ë©ˆì¶°ì‡ì–´ë„ lidarë‘ amcl, local costmapì€ ê³„ì† ì—…ë°ì´íŠ¸ ë˜ê³  ìˆëŠ”ë° ì´ê²Œ ê³¼ì—° ì§„ì§œ idleí•œ ìƒíƒœì¼ê¹Œ? 
ìš©ì–´ë¥¼ ì¬ì •ì˜í•  í•„ìš”ì„±ì´ ìˆë‹¤. 
ì„¼ì„œ ë°ì´í„° í¼ë¸”ë¦¬ì‹±ì„ ìœ ì§€í• ì§€, ë„ëŠ”ì§€ ë“±ë“±
**ì‹¤í—˜ ì¡°ê±´ ëª…í™•í•˜ê²Œ ëª…ì‹œ í•„ìš”**


- ê²°ë¡ ì´ ë„ˆë¬´ ë»”í•¨
ë” ê¹Šê²Œ íŒŒê²Œ: "CPU ì‚¬ìš©ëŸ‰ì´ 10% ì¤„ì–´ë“¤ë©´ ë°°í„°ë¦¬ ìˆ˜ëª…ì´ ëŒ€ëµ ëª‡ ë¶„ ëŠ˜ì–´ë‚  ê²ƒìœ¼ë¡œ ì¶”ì‚°ëœë‹¤"ë¼ê±°ë‚˜, "ë©”ì‹œì§€ ë“œëìœ¨(Drop rate)ì´ íŠ¹ì • êµ¬ê°„ì—ì„œ ê¸‰ì¦í•˜ëŠ” ì„ê³„ì ì´ ì–´ë””ë‹¤" ê°™ì€ **êµ¬ì²´ì ì¸ ìˆ˜ì¹˜(Quantitative Insight)**ë¥¼ ë‚´ë†“ê²Œ



[ìë„¤ê°€ ì§€ê¸ˆ ë‹¹ì¥ í•´ì•¼ í•  ì¼]

    'Idle' ìƒíƒœì¼ ë•Œ ì •í™•íˆ ì–´ë–¤ í† í”½ë“¤ì´ ì˜¤ê°€ê³  ìˆëŠ”ì§€ ë¦¬ìŠ¤íŠ¸ì—… í•´ì˜¤ê²Œ. (ì§„ì§œ ë°ì´í„°ê°€ ì—†ëŠ” ê±´ì§€, Discovery íŒ¨í‚·ë§Œ ì¹˜ëŠ” ê±´ì§€ ì•Œì•„ì•¼ í•  ê²ƒ ì•„ë‹Œê°€.)

    iRobot ë¦¬í¬íŠ¸ë‘ Maruyama ë…¼ë¬¸ ì°¾ì•„ì„œ ì½ê³ , ìë„¤ ì‹¤í—˜ì´ ê·¸ë“¤ë³´ë‹¤ **'ë” ë‚˜ì€ ì '**ì´ ë­”ì§€ í•œ ë¬¸ì¥ìœ¼ë¡œ ê°€ì ¸ì˜¤ê²Œ.



'ì´ ì •ë„ì˜ ì†í•´(Trade-off)ë¥¼ ê°ìˆ˜í•˜ê³ ì„œë¼ë„ ë°”ê¿€ ê°€ì¹˜ê°€ ìˆëŠ”ì§€' ì¦ëª…


Cycloneìœ¼ë¡œ ë°”ê¿¨ë”ë‹ˆ Idle ì‹œ CPU ì ìœ ìœ¨ì´ 5% ë–¨ì–´ì¡Œê³ , ì´ëŠ” ì´ë¡ ìƒ ë°°í„°ë¦¬ ìˆ˜ëª…ì„ 30ë¶„ ì—°ì¥í•˜ëŠ” íš¨ê³¼ê°€ ìˆë‹¤' ì²˜ëŸ¼ êµ¬ì²´ì ì¸ ì´ë“(Benefit)ì„ ì œì‹œí•´ì•¼ì§€


ê¶ê¸ˆí•´ì„œ í•´ë´¤ë‹¤? ê·¸ê±´ ì´ˆë“±í•™ìƒ ì¼ê¸°ì¥ì—ë‚˜ ì“°ëŠ” ë§ì¼ì„¸."

"ìë„¤, ë°©ê¸ˆ 'DDSì— ë”°ë¼ ë¶€í•˜ê°€ ì–´ë–»ê²Œ ë‹¤ë¥¸ì§€ ì•Œê³  ì‹¶ì–´ì„œ', 'Fast DDSê°€ ë””í´íŠ¸ì¸ ì´ìœ ê°€ ìˆê² ì§€ë§Œ ë‹¤ë¥¸ ê²ƒë„ ê¶ê¸ˆí•´ì„œ'ë¼ê³  í–ˆë‚˜? ì—°êµ¬ëŠ” 'ê¶ê¸ˆì¦ í•´ê²°'ì´ ì•„ë‹ˆë¼ **'ê°€ì„¤ ê²€ì¦(Hypothesis Verification)'**ì´ì–´ì•¼ í•´.

"Cycloneì€ ë©ˆì¶° ìˆì„ ë•Œ ì™œ ì¡°ìš©í•œê°€? Fast DDSëŠ” ì™œ ì‹œë„ëŸ¬ìš´ê°€? ë©€í‹°ìºìŠ¤íŠ¸(Multicast) í­ì£¼ ë¬¸ì œì¸ê°€, ì•„ë‹ˆë©´ ê³µìœ  ë©”ëª¨ë¦¬(Shared Memory) ì„¤ì • ì´ìŠˆì¸ê°€? ì›ì¸ ë¶„ì„ ì—†ì´ ê²°ê³¼ ê·¸ë˜í”„ë§Œ ë¡ ë³´ì—¬ì£¼ë©´ì„œ 'Aê°€ ë‚®ë„¤ìš”'ë¼ê³  í•˜ëŠ” ê±´ ì—”ì§€ë‹ˆì–´ê°€ ì•„ë‹ˆë¼ ë‹¨ìˆœ ì¸¡ì • ì•„ë¥´ë°”ì´íŠ¸ë‚˜ í•˜ëŠ” ì¼ì´ì•¼. **'ì •ì§€ ìƒíƒœì—ì„œì˜ Discovery íŠ¸ë˜í”½ ì°¨ì´'**ë¥¼ ì–¸ê¸‰í•˜ì§€ ì•Šì„ ê±°ë©´ ì´ íŒŒíŠ¸ëŠ” ë¹¼ê²Œ."

ì§€ì : "ê·¸ê±´ êµ¬ê¸€ ê²€ìƒ‰í•˜ë©´ 10ì´ˆ ë§Œì— ë‚˜ì™€. iRobotì´ ì´ë¯¸ 2021ë…„ì— ë‹¤ ë°í˜€ëƒˆì–´. ìë„¤ëŠ” ë‚¨ë“¤ì´ ë‹¤ í•´ë†“ì€ ë°¥ìƒì— ìˆŸê°€ë½ë§Œ ì–¹ê² ë‹¤ëŠ” ê±´ê°€? Nav2 í™˜ê²½ì—ì„œ ì‹¤í—˜í•œë‹¤ê³  í–ˆì§€? ê·¸ëŸ¼ ì ì–´ë„ 'ë‹¨ìˆœ í†µì‹  í…ŒìŠ¤íŠ¸ì—ì„œëŠ” ì•ˆ ë³´ì´ë˜ ë¬¸ì œê°€, ë¬´ê±°ìš´ Nav2 ìŠ¤íƒê³¼ ê²°í•©ë  ë•Œ ì–´ë–¤ ë¹„ì„ í˜•ì ì¸ ë¶€í•˜(Non-linear Overhead)ë¥¼ ë§Œë“¤ì–´ë‚´ëŠ”ì§€' ë³´ì—¬ì¤˜ì•¼ í•  ê±° ì•„ë‹Œê°€!"


**"ë‚¨ë“¤ì´ ë­˜ í–ˆëŠ”ì§€ ì•Œì•„ì•¼ ë‚´ê°€ ë­˜ ë” í•  ìˆ˜ ìˆëŠ”ì§€(Gap Analysis)"**ê°€ ë³´ì´ëŠ” ë²•. ì„ í–‰ ì—°êµ¬ ì¡°ì‚¬(Literature Review) ì—†ì´ëŠ” ìë„¤ ì‹¤í—˜ì´ 'ì‚½ì§ˆ'ì¸ì§€ 'ë°œê²¬'ì¸ì§€ ì¦ëª…í•  ê¸¸ì´ ì—†ì–´.

ë…¼ë¬¸ì€ 'ê¹Œê¸°(Critique)' ìœ„í•´ì„œ ì¸ìš©







----


## ì—¬ëŸ¬ ë…¼ë¬¸ ì½ìœ¼ë©´ì„œ ì“¸ë§Œí•œ ë‚´ìš© ê±´ì§€ê¸°

- Exploring the Performance of ROS2 (2016)
ì•„ ì ë§Œ, 2016ì´ 10ë…„ì „ì´ë¼ê³ ? 

ros2 ì´ˆì°½ê¸°ì— ë‚˜ì˜´ 

however, this(DDS) incurs additional overhead, which is examined in this study

Transport latencies between ROS2 nodes vary depending on the use cases, data size, configurations, and DDS vendors

ì¸¡ì •í•œ ìš”ì†Œë“¤ : latency, throughput, the number of threads, memory consumbtion
ë³€ìˆ˜ : DDS, Qos Policies

evalutate end-to-end latencies for publish/subscribe message

we sould use a different DDS implementation for different situations

ì—¬ê¸°ì„œëŠ” ROS1 ê³¼ ROS2 ì„±ëŠ¥ ë¹„êµë„ ì§„í–‰í•¨ 



- ê³µí†µì ìœ¼ë¡œ ros1ì€ real-time systemì— ë¶€ì ê²©í•˜ë‹¤ê³  í•¨ 
However, ROS1 lacks real-time capable communication



**zero copy ê´€ë ¨**

*iceoryx*

- Shared-Memory-Based Lock-Free Qeues: The Key to Fast and Robust Communication on Safety-Critical Edge Devices (2023)
  discuss the motivations and design decisions behind these iceoryx intra-host channels.
  middleware needs to provide high performance, guarantee robustness against component failure, and allow for decoupling between different components.

not only needs to deliver high performance for data-intensive sensor applications and low latency for real-time decision-making,

but also do so in a robust and fault-tolerant manner to avoid catastrophic failures
 
data links between the applicationâ€™s components are usually provided by a middleware

ì‹œìŠ¤í…œ í•˜ë‚˜ê°€ ì£½ì—ˆë‹¤ê³  í†µìœ¼ë¡œ ëª¨ë‘ê°€ ì£½ìœ¼ë©´ ì•ˆë¨ & ë‹¤ë¥¸ ì–˜ ì¢…ë£Œì‹œí‚¤ê±°ë‚˜ ë°ë“œë½ ê±¸ë¦¬ê²Œ í•˜ë©´ ì•ˆë¨ 

ë¹„ë™ê¸° í†µì‹ (Asynchronous)ì™€ í¬ê¸° ì¡°ì ˆì´ ê°€ëŠ¥í•œ ì›í˜• ë²„í¼ ë°©ì‹ ì±„íƒ 

lceoryx : zero copy & History policyë§Œ ë‹¤ë¥´ê²Œ ì„¤ì •í•´ì„œ ë‹¤ì–‘í•œ os í”„ë¡œì„¸ìŠ¤ì˜ ìš”êµ¬ì‚¬í•­ ë§Œì¡±ì‹œí‚´ 

Sampling Strategy : ëª¨ë“  ë°ì´í„°ëŠ” ë‹¤ ë³¼ í•„ìš”ê°€ ì—†ë‹¤. ë‹¤ ë³´ë ¤ê³  ìš•ì‹¬ë‚´ë‹¤ê°€ Latency ì‚¬ê³  í„°ì§ˆ ìˆ˜ ìˆìŒ 
ê°€ì¥ ìµœì‹ ê²ƒë§Œ ê°€ì ¸ì˜¤ê³  ë‚˜ë¨¸ì§€ëŠ” ë²„ë¦¬ëŠ” ìœ ì—°í•¨ í•„ìˆ˜ 

ì„±ëŠ¥ì„ ì¤‘ì‹œí•˜ë©´ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ì—, ì•ˆì •ì„ ì¤‘ì‹œí•˜ë©´ í”„ë¡œì„¸ìŠ¤ ë¶„ë¦¬ 

Trade off : 
data copy cost >>>> fault 

Pre-allocating a poll : í”„ë¡œê·¸ë¨ ì‹œì‘ ì „ì— ê±°ëŒ€í•œ ë©”ëª¨ë¦¬ ë©ì–´ë¦¬ ì˜ê²Œ ìª¼ê°œì„œ ë¹ˆ ì°½ê³  ê³µê°„ ë§Œë“¤ì–´ë‘  -> malloc, new í•„ìš”ì—†ìŒ 

Producer allocates a fresh segment : ê·¸ëƒ¥ ë¹ˆ ì„¸ê·¸ë¨¼íŠ¸ì— ì‘ì„±í•¨ 

Reference count : ì°¸ì¡° ì¹´ìš´íŠ¸ ìˆ˜ê°€ 0ì¼ ë•Œë§Œ ë°˜ë‚© 

allocator : non deterministicí•¨ 

fixed size segment ì‚¬ìš©í•´ì„œ fragmentation ì—†ë„ë¡í•¨ 

ì†Œë¹„ìë‹¹ í• ë‹¹ ì œí•œ ìˆìŒ 

ê·¼ë° ì´ì „ ë°ì´í„°ë¥¼ ì €ì¥í•´ì•¼í•  í•„ìš”ì„± ì¡´ì¬

ë‹¨ìˆœ ê³µìœ  ë©”ëª¨ë¦¬ ë³€ìˆ˜ -> lock free íë¡œ ì§„í™” 

íê°€ ê½‰ ì°¨ë©´ ì˜¤ë˜ëœ ë°ì´í„° ë°€ì–´ë‚´ê³  ìƒˆë¡œìš´ ë°ì´í„° ë„£ê¸°  â†’ ì–¸ì œë‚˜ ìµœì‹  ë°ì´í„° ìœ ì§€í•  ìˆ˜ ìˆë„ë¡ 

Non-blocking ì•Œê³ ë¦¬ì¦˜ì˜ ë“±ê¸‰
1. Wait-Free (ì½”ë“œ ë„ˆë¬´ ë³µì¡í•¨ )
2. Lock-Free
3. Obstruction-Free(ì‹¤ì‹œê°„ ì‹œìŠ¤í…œì— ë¶€ì í•© )

**"ìˆ˜í•™ì  ì¦ëª…(Formal Verification)"**ê³¼ **"íŠ¹ìˆ˜ ë„êµ¬"**

ì½”ë“œë¥¼ ëŒë ¤ë³´ëŠ” ê²Œ ì•„ë‹ˆë¼, ìˆ˜í•™ ê³µì‹ìœ¼ë¡œ ëª¨ë¸ë§í•´ì„œ ì¦ëª…í•©ë‹ˆë‹¤.
- ThreadSanitizer
- Helgrind
- Relacy Race Detector


---

https://discourse.openrobotics.org/t/new-fast-dds-performance-testing/29539 
ëˆ„ê°€ ì´ë¯¸ í…ŒìŠ¤íŠ¸ í•œê±° 

- fast dds two processes
- fast dds two processes with loans
- cyclone dds two processes
- cyclon dds two processes with loans
- open dds tow precesses



# ê°€ì„¤ ì„¤ë¦½ (0106)

ì˜¤ëŠ˜ í• ê±°
1. ê°€ì„¤ ìˆ˜ë¦½
2. ë³€ìˆ˜ í†µì œ
3. ê²°ë¡  ìˆ˜ì¹˜í™”

íŠœë‹ì„ ì–´ë–»ê²Œ í•˜ëŠëƒì— ë”°ë¼ ì„±ëŠ¥ ì²œì°¨ë§Œë³„


### ì‹¤í—˜ í™˜ê²½ ì„¤ì • 

- 4ì½”ì–´ë¡œ ì‹¤í–‰ 
```
docker run -it --cpus="4" --name ros2_test_env ros-humble-desktop

taskset -c 0,1,2,3 ros2 launch nav2_bringup tb3_simulation_launch.py
```

### XML ì„¤ì •ì„ í†µí•œ DDS íŠœë‹

file ë§Œë“  í›„ì— ì‹¤í–‰ ì „ í„°ë¯¸ë„ì— ìœ„ì¹˜ ì•Œë ¤ì¤˜ì•¼í•¨ 

1. file ìƒì„± : fastdds_profile.xml





### ê°œë… ì„¤ëª… 

1. what is Fass DDS?
a high-performance C++ implementation of the OMG Data Distribution Service (DDS) standard

2. What is Cyclon DDS?